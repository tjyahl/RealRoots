%Real Roots  JSAG version
%
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt]{amsart}
\usepackage[margin = 1in]{geometry}
\usepackage{amsmath,amssymb,amsthm,mathtools}
\usepackage[dvipsnames]{xcolor}
\usepackage{ulem}  % strike out text
\usepackage{graphicx}
\usepackage{tikz,verbatim}
\usepackage{caption}
\usepackage{float}
\usepackage{booktabs}
\usepackage{subcaption}
%\pdfoutput=1

\usepackage{framed}

%Environments
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{algorithm}[theorem]{Algorithm}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}


%Macros
\newcommand{\CC}{\mathbb{C}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\NN}{\mathbb{N}}

\DeclareMathOperator{\var}{{\rm var}}
\DeclareMathOperator{\Syl}{{\rm Syl}}

\newcommand{\defcolor}[1]{{\color{Maroon}#1}}
\newcommand{\demph}[1]{\defcolor{{\sl #1}}}
\newcommand{\note}[1]{{\color{red}(#1)}}


\title{real solutions of polynomial systems}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\author[J.~Lopez Garcia]{Jordy Lopez Garcia} 
\address{J.~Lopez Garcia\\ 
         Department of Mathematics\\ 
         Texas A\&M University\\ 
         College Station\\ 
         Texas \ 77843\\ 
         USA} 
\email{jordy.lopez@tamu.edu}
\urladdr{https://jordylopez27.github.io/}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\author[K.~Maluccio]{Kelly Maluccio} 
\address{K.~Maluccio\\ 
         Department of Mathematics\\ 
         Austin Community College\\ 
         Austin\\ 
         Texas \ 78752\\ 
         USA} 
\email{kmaluccio@gmail.com}
\urladdr{https://github.com/kmaluccio}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\author[F.~Sottile]{Frank Sottile} 
\address{F.~Sottile\\ 
         Department of Mathematics\\ 
         Texas A\&M University\\ 
         College Station\\ 
         Texas \ 77843\\ 
         USA} 
\email{sottile@tamu.edu} 
\urladdr{https://www.math.tamu.edu/\~{}sottile} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\author[T.~Yahl]{Thomas Yahl} 
\address{T.~Yahl\\ 
         Department of Mathematics\\ 
         Texas A\&M University\\ 
         College Station\\ 
         Texas \ 77843\\ 
         USA} 
\email{thomasjyahl@tamu.edu} 
\urladdr{https://tjyahl.github.io/} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\thanks{Research supported in part by Simons Collaboration Grant for Mathematicians 636314.}
\subjclass[2010]{}
%
%
%
\keywords{Sturm Theorem, Budan-Fourier Theorem, trace form}
\thanks{\texttt{RealRoots} version 0.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Beginning
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%   Abstract
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
 The \textit{Macaulay2} package \texttt{RealRoots} provides symbolic methods to study real solutions to systems of polynomial equations.
 It updates and expands an earlier package developed by Sottile and Grayson in 1999.
 We provide some mathematical background and descriptions of the  \texttt{RealRoots} package, giving examples which illustrate some of its
 implemented methods.
 We also prove a general version of Sylvester's Theorem.
\end{abstract}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\maketitle


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Introduction  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Introduction}

%historical background/motivation, discussion of prior results, contribution and why it's important/interesting/novel

Understanding the number of real solutions to systems of polynomials is a fundamental for real algebraic geometry and applications of
algebraic geometry.
In 1999, Grayson and Sottile \cite{So_M2} developed the \textit{Macaulay2} package \texttt{realroots} for this purpose.
That package had limited functionality and not all of its implemented methods remain compatible with modern releases of \textit{Macaulay2}.

The \textit{Macaulay2} package \texttt{RealRoots} expands and modernizes \texttt{realroots}, superseding it.
\texttt{RealRoots} implements symbolic methods for studying real solutions of polynomial systems.
This note provides some descriptions of the mathematical background, and examples of methods from the package.
It is organized into three sections, each describing related methods.

Section 1 describes methods for counting and isolating real roots of univariate polynomials, as well as methods for determining if a
polynomial is Hurwitz stable.
We could not find a proof of Sylvester's Theorem~\ref{Th:Sylvester} in complete generality in the literature, and have included a sketch for
completeness. 

Section 2 describes methods involving elimination that reduce a zero-dimensional system of multivariate polynomials to a univariate
polynomial for solving, studying the number of real solutions, or addressing other arithmetic questions, such as Galois groups.

Section 3 describes a further method for studying zero-dimensional systems, based on the trace form.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Real roots of univariate polynomials}

Let $f\in\RR[x]$ be a polynomial.
It has the form
%
 \[
   f\ =\ c_{0}x^{a_{0}} + c_{1}x^{a_{1}} + \cdots + c_{m}x^{a_{m}}\,,
 \]
%
$a_{0} < a_{1} < \cdots < a_{m}$ are nonnegative integers and for $0\leq i \leq m$, $c_{i}$ is a nonzero real number.
Let $\defcolor{\var(c_0,\dotsc,c_m)}\vcentcolon=\#\{1\leq i\leq m\mid c_{i-1}c_i<0\}$ be the number of sign variations in the coefficients
of $f$.
Descartes' Rule of Signs \cite{So_Book} gives an upper bound for the number of positive real roots of $f$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{theorem}[Descartes' Rule of Signs]
  The number of positive real roots of $f$, counted with multiplicity is at most $\var(c_0,\dotsc,c_m)$ and it has the same parity
  as $\var(c_0,\dotsc,c_m)$.
\end{theorem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

More generally, given any sequence $c=(c_0,\dotsc,c_m)$, we compute the \demph{variation} of $c$, $\var(c)$, by counting the number of
variations in sign after removing all zero terms.
%
\begin{leftbar}
\verbatiminput{examples/variations.txt}
\end{leftbar}
%
For sequence of polynomials  $\defcolor{f_\bullet}=(f_0,\dotsc,f_k)$ in $\RR[x]$ and $a\in\RR$, \defcolor{$\var(f_\bullet,a)$} is the
variation in the sequence 
$(f_0(a),\dotsc,f_{k}(a))$. 
We extend this to $a=\pm\infty$, by taking $f(\infty)$ to be the leading coefficient of $f(x)$ and $f(-\infty)$ to be the leading
coefficient of $f(-x)$.

Given a polynomial $f\in\RR[x]$ of degree $\ell$, consider its sequence of derivatives,
%
 \[
   \defcolor{\delta f}\ \vcentcolon= \left(f(x),d'(x),d''(x),\dots,d^{(l)}(x)\right)\,.
 \]
%
For $a,b\in \RR\cup\{\pm \infty\}$ with $a<b$, let \defcolor{$r(f,a,b)$} be the number of roots of $f$ in the interval $(a,b\hspace{.05cm}]$, counted
with multiplcity.
Budan and Fourier~\cite[Ch.\ 2]{So_Book} generalized Descartes' Rule.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{theorem}[Budan-Fourier]
  We have that $r(f,a,b)\leq \var(\delta f,a) -\var(\delta f,b)$, and the difference
  $\var(\delta f,a) -\var(\delta f,b)-r(f,a,b)$ is even. 
\end{theorem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Descartes' Rule is when $a=0$ and $b=\infty$.
Let us consider an example.
%
\begin{leftbar}
\verbatiminput{examples/BudanFourierBound.txt}
\end{leftbar}
%
When called on a polynomial, \texttt{BudanFourierBound} assumes that $a=-\infty$ and $b=\infty$, giving a bound for all real roots.
Note that $r(f,0,\infty)=4$ and $r(f,-\infty,\infty)=7$.

In contrast to these bounds, 
Sylvester's Theorem determines the actual number of real roots, and more.
The \demph{Sylvester sequence}, \defcolor{$\Syl(f,g)$} of polynomials $f,g\in\RR[x]$ is the sequence
$\left(f_0,f_1,\dotsc,f_k\right)$ of nonzero polynomials, where $f_0\vcentcolon= f, f_1 \vcentcolon= f'\cdot g$,
and for $i\geq 1$, 
%
  \[
    f_{i+1}\ \vcentcolon=\ -1\cdot \mbox{remainder}(f_{i-1},f_i)\,,
  \]
%
the negative remainder term in the division of $f_{i-1}$ by $f_i$.
Note that we have $f_k = \gcd(f,f'g)$ and for each $i=0,\dotsc,k$ there exists $q_i\in\RR[x]$ such that
%
 \begin{equation}\label{Eq:divisionAlgorithm}
    f_{i-1}\ =\ q_i(x)f_i(x)-f_{i+1}(x)\,.
 \end{equation}
%
The \demph{reduced Sylvester sequence} is obtained by dividing each term each term in the Sylvester sequence by $f_k$.
Note that the elements $(g_1,\dotsc,g_k)$ of the reduced sequence satisfy~\eqref{Eq:divisionAlgorithm} with $f_j$ replacing $g_j$, and also
that $g_k=1$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{theorem}[Sylvester]
  \label{Th:Sylvester}
  Let $f,g\in\RR[x]$ and suppose that $g_\bullet$ is the reduced Sylvester sequence of $f$ and $f'g$.
  For $a<b$ in $\RR\cup\{\pm\infty\}$ we have,
  %
  \begin{multline*}
    \qquad\var(g_\bullet,a)-\var(g_\bullet,b)\ =\
    \#\{\zeta\in(a,b\hspace{.05cm}]\mid f(\zeta)=0\mbox{ and } g(\zeta)>0\}\\
      \ -\
    \#\{\zeta\in[a,b)\mid f(\zeta)=0\mbox{ and } g(\zeta)<0\}\,.\qquad
  \end{multline*}
\end{theorem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{proof}
  In~\cite{BCR}\footnote{Give a more precise reference}, this is stated and provenin the case when $f$ does not vanish at $a$ or at $b$,
  and for the Sylvester sequence $\Syl(f,f'g)$, not the reduced Syvester sequence.
  The proof proceeds by studying the variation $\var(\Syl(f,g), t)$ as $t$ increases fron $a$ to $b$, noting that this quantity may only
  change when $t$ passes a root of some member of the Sylvester sequence $\Syl(f,g)$.
  Since multiplying a sequence by a nonzero number $f_K(t)$ does not change its variation, the proof in~\cite{BCR} establishes the theorem
  when $f$ does not vanish at $a$ or at $b$.

  The variation $\var(g_\bullet,t)$ can only change when $t$ passes a root $\zeta$ of some polynomial $g_i$ in the reduced Sylvester
  sequence $g_\bullet$, or possibly when the
  root $\zeta$ is an   endpoint of $[a,b\hspace{.05cm}]$.
  Observe that $\zeta$ cannot be a root of two consecutive elements of $g_\bullet$.
  If it were, then by~\eqref{Eq:divisionAlgorithm} and an induction, it is a root of all elements of $g_\bullet$, and thus of $g_k=1$, which is a
  contradiction.
  Suppose that $g_i(\zeta)=0$ for some $i\geq 1$.
  By~\eqref{Eq:divisionAlgorithm} again $g_{i-1}(\zeta)$ and $g_{i+1}(\zeta)$ have opposite signs in a neighborhood of $\zeta$ and thus
  $g_{i-1},g_i,g_{i+1}$ do not contribute to any change in $\var(G,t)$ for $t$ in a neighborhood of $\zeta$.
  This in particular remains true if $\zeta=a$ and $t$ increases from $a$ or if $\zeta=b$ and $t$ approaches $b$.


 \end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%Sturm's theorem
\corollary[Sturm's Theorem]
Let $f$ be a univariate polynomial and $a,b\in \mathbb{R}\cup\{\pm\infty\}$ with $a<b$ and $f(a),f(b)\neq 0$. Then the number of zeros of $f$ in the interval $(a,b\hspace{.05cm}]$ is the difference 
\begin{align*}
\text{var}(F,a) - \text{var}(F,b),
\end{align*}
where $F$ is the Sturm sequence of $f$.

%Real root isolation


%Hurwitz stability
\theorem
Let $f(x) = \sum_{j=0}^{n}a_{j}x^{j}$ with $n\geq 1$ and $a_{n}>0$. Then $f$ is Hurwitz stable if and only if all the Hurwitz determinants $\delta_{1},\dots,\delta_{n}$ are all positive.
%
%M2 examples along the way
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Elimination}
%regular reprersentation and Stickelberger's theorem?
%what we mean by elimination (minimal polynomial in Artinian ring)
%this is an univariate eliminant in the case ring element is variable
%rational univariate eliminant uses characteristic polynomial instead of minimal polynomial
%for zero-dimensional real systems, this gives an effective way to compute real solutions
%

I think we should do a Galois computation of 27 lines on a symmetric cubic surface.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Real root location}
%trace form
%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{1}

\bibitem{BCR}
J.~Bochnak, M.~Coste, and M.-F. Roy.
\newblock {\em Real algebraic geometry}, volume~36 of {\em Ergebnisse der
  Mathematik und ihrer Grenzgebiete (3)}.
\newblock Springer-Verlag, Berlin, 1998.

\bibitem{So_M2}
F.~Sottile.
\newblock From enumerative geometry to solving systems of polynomials
  equations.
\newblock In {\em Computations in algebraic geometry with {M}acaulay 2},
  volume~8 of {\em Algorithms Comput. Math.}, pages 101--129. Springer, Berlin,
  2002.

\bibitem{So_Book}
F.~Sottile.
\newblock {\em Real solutions to equations from geometry}, volume~57 of {\em
  University Lecture Series}.
\newblock American Mathematical Society, Providence, RI, 2011.

\end{thebibliography}


\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\bibliographystyle{abbrv}
%\bibliographystyle{amsplain}
\bibliography{jsag}

\end{document}
